<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Logo Command Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
        }

        .test {
            margin: 10px 0;
        }

        button {
            padding: 10px 15px;
            margin: 5px;
        }

        canvas {
            border: 2px solid black;
            margin: 20px 0;
        }

        .log {
            background: #f0f0f0;
            padding: 10px;
            font-family: monospace;
            max-height: 300px;
            overflow-y: auto;
        }
    </style>
</head>

<body>
    <h1>üê¢ Logo Command Direct Test</h1>

    <div class="test">
        <button onclick="testBasicSquare()">Test Basic Square</button>
        <button onclick="testColoredSquare()">Test Colored Square</button>
        <button onclick="testYourProgram()">Test Your Program (Fixed)</button>
        <button onclick="clearCanvas()">Clear Canvas</button>
    </div>

    <canvas id="graphicsCanvas" width="400" height="400"></canvas>

    <div class="log" id="log">Ready for Logo command test...</div>

    <script src="js/interpreter.js"></script>

    <script>
        let interpreter, log;

        function init() {
            interpreter = new TimeWarpInterpreter();
            log = document.getElementById('log');

            // Set up output callback
            interpreter.onOutput = function (text) {
                logMsg(text);
            };

            // Initialize turtle
            const canvas = document.getElementById('graphicsCanvas');
            interpreter.turtle = new WorkingTurtle(canvas);

            logMsg('Interpreter and turtle initialized');
        }

        function logMsg(msg) {
            console.log(msg);
            log.innerHTML += msg + '<br>';
            log.scrollTop = log.scrollHeight;
        }

        async function testBasicSquare() {
            logMsg('\n=== BASIC SQUARE TEST ===');

            try {
                await interpreter.executeLogoCommand('CLEARSCREEN');
                await interpreter.executeLogoCommand('FORWARD 100');
                await interpreter.executeLogoCommand('RIGHT 90');
                await interpreter.executeLogoCommand('FORWARD 100');
                await interpreter.executeLogoCommand('RIGHT 90');
                await interpreter.executeLogoCommand('FORWARD 100');
                await interpreter.executeLogoCommand('RIGHT 90');
                await interpreter.executeLogoCommand('FORWARD 100');

                logMsg('‚úÖ Basic square test completed');
            } catch (error) {
                logMsg('‚ùå Basic square test failed: ' + error.message);
            }
        }

        async function testColoredSquare() {
            logMsg('\n=== COLORED SQUARE TEST ===');

            try {
                await interpreter.executeLogoCommand('CLEARSCREEN');
                await interpreter.executeLogoCommand('SETCOLOR blue');
                await interpreter.executeLogoCommand('FORWARD 100');
                await interpreter.executeLogoCommand('RIGHT 90');
                await interpreter.executeLogoCommand('SETCOLOR red');
                await interpreter.executeLogoCommand('FORWARD 100');
                await interpreter.executeLogoCommand('RIGHT 90');
                await interpreter.executeLogoCommand('SETCOLOR green');
                await interpreter.executeLogoCommand('FORWARD 100');
                await interpreter.executeLogoCommand('RIGHT 90');
                await interpreter.executeLogoCommand('SETCOLOR orange');
                await interpreter.executeLogoCommand('FORWARD 100');

                logMsg('‚úÖ Colored square test completed');
            } catch (error) {
                logMsg('‚ùå Colored square test failed: ' + error.message);
            }
        }

        async function testYourProgram() {
            logMsg('\n=== YOUR PROGRAM (FIXED) ===');

            try {
                // Set the size variable first
                interpreter.variables.set('size', 100);
                logMsg('Set size = 100');

                // Your program with fixed variable references
                await interpreter.executeLogoCommand('CLEARSCREEN');
                await interpreter.executeLogoCommand('PENDOWN');
                await interpreter.executeLogoCommand('SETCOLOR blue');
                await interpreter.executeLogoCommand('FORWARD 100'); // Fixed: removed *size*
                await interpreter.executeLogoCommand('RIGHT 90');
                await interpreter.executeLogoCommand('SETCOLOR red');
                await interpreter.executeLogoCommand('FORWARD 100');
                await interpreter.executeLogoCommand('RIGHT 90');
                await interpreter.executeLogoCommand('SETCOLOR green');
                await interpreter.executeLogoCommand('FORWARD 100');
                await interpreter.executeLogoCommand('RIGHT 90');
                await interpreter.executeLogoCommand('SETCOLOR orange');
                await interpreter.executeLogoCommand('FORWARD 100');

                logMsg('‚úÖ Your program (fixed) completed');
            } catch (error) {
                logMsg('‚ùå Your program test failed: ' + error.message);
            }
        }

        function clearCanvas() {
            if (interpreter && interpreter.turtle) {
                interpreter.turtle.clearCanvas();
                logMsg('Canvas cleared');
            }
        }

        window.addEventListener('load', init);
    </script>
</body>

</html>