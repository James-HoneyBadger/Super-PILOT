<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Minimal Graphics Test</title>
    <style>
        canvas {
            border: 2px solid red;
            background: white;
            display: block;
            margin: 20px;
        }

        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }
    </style>
</head>

<body>
    <h1>Minimal Graphics Test</h1>
    <p>This test bypasses all the complex IDE code and tests graphics directly.</p>

    <canvas id="testCanvas" width="400" height="400"></canvas>

    <button onclick="testBasicCanvas()">1. Test Basic Canvas</button>
    <button onclick="testTurtleGraphics()">2. Test TurtleGraphics Class</button>
    <button onclick="testWithCommands()">3. Test Graphics Commands</button>

    <div id="log"></div>

    <script>
        function log(msg) {
            const logDiv = document.getElementById('log');
            logDiv.innerHTML += '<div>' + msg + '</div>';
            console.log(msg);
        }

        function testBasicCanvas() {
            log('=== Testing Basic Canvas ===');
            const canvas = document.getElementById('testCanvas');
            const ctx = canvas.getContext('2d');

            log('Canvas: ' + !!canvas);
            log('Context: ' + !!ctx);
            log('Canvas size: ' + canvas.width + 'x' + canvas.height);

            // Clear and draw a simple rectangle
            ctx.fillStyle = 'lightblue';
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            ctx.fillStyle = 'red';
            ctx.fillRect(50, 50, 100, 100);

            ctx.strokeStyle = 'black';
            ctx.lineWidth = 3;
            ctx.strokeRect(200, 200, 150, 100);

            log('Basic canvas drawing completed');
        }

        function testTurtleGraphics() {
            log('=== Testing TurtleGraphics Class ===');

            // Inline simple turtle graphics class
            class SimpleTurtle {
                constructor(canvas) {
                    this.canvas = canvas;
                    this.ctx = canvas.getContext('2d');
                    this.x = canvas.width / 2;
                    this.y = canvas.height / 2;
                    this.heading = 90; // degrees, 90 = up
                    this.isPenDown = true;
                    this.penColor = 'blue';

                    log('SimpleTurtle created at (' + this.x + ', ' + this.y + ')');
                    this.clearScreen();
                }

                clearScreen() {
                    this.ctx.fillStyle = 'white';
                    this.ctx.fillRect(0, 0, this.canvas.width, this.canvas.height);
                    log('Screen cleared');
                }

                forward(distance) {
                    const radians = (this.heading - 90) * Math.PI / 180;
                    const newX = this.x + Math.cos(radians) * distance;
                    const newY = this.y + Math.sin(radians) * distance;

                    if (this.isPenDown) {
                        this.ctx.beginPath();
                        this.ctx.moveTo(this.x, this.y);
                        this.ctx.lineTo(newX, newY);
                        this.ctx.strokeStyle = this.penColor;
                        this.ctx.lineWidth = 2;
                        this.ctx.stroke();
                        log('Drew line from (' + this.x.toFixed(1) + ', ' + this.y.toFixed(1) + ') to (' + newX.toFixed(1) + ', ' + newY.toFixed(1) + ')');
                    }

                    this.x = newX;
                    this.y = newY;
                    log('Turtle moved to (' + this.x.toFixed(1) + ', ' + this.y.toFixed(1) + ')');
                }

                right(angle) {
                    this.heading = (this.heading + angle) % 360;
                    log('Turtle turned right ' + angle + '°, now facing ' + this.heading + '°');
                }
            }

            try {
                const canvas = document.getElementById('testCanvas');
                const turtle = new SimpleTurtle(canvas);

                log('Drawing a square...');
                turtle.forward(100);
                turtle.right(90);
                turtle.forward(100);
                turtle.right(90);
                turtle.forward(100);
                turtle.right(90);
                turtle.forward(100);
                turtle.right(90);

                log('Square drawing completed');

            } catch (error) {
                log('ERROR: ' + error.message);
            }
        }

        function testWithCommands() {
            log('=== Testing Command-Based Graphics ===');

            const canvas = document.getElementById('testCanvas');
            const ctx = canvas.getContext('2d');

            // Simple command interpreter
            function executeCommand(cmd) {
                log('Executing: ' + cmd);

                if (cmd === 'CLEARSCREEN') {
                    ctx.fillStyle = 'white';
                    ctx.fillRect(0, 0, canvas.width, canvas.height);
                    log('Screen cleared via command');

                } else if (cmd.startsWith('FORWARD')) {
                    const distance = parseInt(cmd.split(' ')[1]) || 50;
                    ctx.beginPath();
                    ctx.moveTo(200, 200);
                    ctx.lineTo(200 + distance, 200);
                    ctx.strokeStyle = 'green';
                    ctx.lineWidth = 3;
                    ctx.stroke();
                    log('Drew forward line, distance: ' + distance);
                }
            }

            // Test commands
            executeCommand('CLEARSCREEN');
            executeCommand('FORWARD 100');

            log('Command-based drawing completed');
        }

        // Auto-run basic test on load
        window.addEventListener('load', () => {
            log('Page loaded');
            testBasicCanvas();
        });
    </script>
</body>

</html>